(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["subpkg/pages/demanddetails/demanddetails"],{133:function(t,e,n){"use strict";(function(t){n(5);a(n(3));var e=a(n(134));function a(t){return t&&t.__esModule?t:{default:t}}wx.__webpack_require_UNI_MP_PLUGIN__=n,t(e.default)}).call(this,n(1)["createPage"])},134:function(t,e,n){"use strict";n.r(e);var a=n(135),i=n(137);for(var o in i)"default"!==o&&function(t){n.d(e,t,(function(){return i[t]}))}(o);n(139),n(141);var d,s=n(17),c=Object(s["default"])(i["default"],a["render"],a["staticRenderFns"],!1,null,null,null,!1,a["components"],d);c.options.__file="subpkg/pages/demanddetails/demanddetails.vue",e["default"]=c.exports},135:function(t,e,n){"use strict";n.r(e);var a=n(136);n.d(e,"render",(function(){return a["render"]})),n.d(e,"staticRenderFns",(function(){return a["staticRenderFns"]})),n.d(e,"recyclableRender",(function(){return a["recyclableRender"]})),n.d(e,"components",(function(){return a["components"]}))},136:function(t,e,n){"use strict";var a;n.r(e),n.d(e,"render",(function(){return i})),n.d(e,"staticRenderFns",(function(){return d})),n.d(e,"recyclableRender",(function(){return o})),n.d(e,"components",(function(){return a}));try{a={uNavbar:function(){return n.e("uview-ui/components/u-navbar/u-navbar").then(n.bind(null,285))},uCountDown:function(){return n.e("uview-ui/components/u-count-down/u-count-down").then(n.bind(null,331))},uPopup:function(){return n.e("uview-ui/components/u-popup/u-popup").then(n.bind(null,345))},release:function(){return Promise.all([n.e("common/vendor"),n.e("components/release/release")]).then(n.bind(null,373))},dropball:function(){return n.e("components/dropball/dropball").then(n.bind(null,292))}}}catch(s){if(-1===s.message.indexOf("Cannot find module")||-1===s.message.indexOf(".vue"))throw s;console.error(s.message),console.error("1. 排查组件名称拼写是否正确"),console.error("2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom"),console.error("3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件")}var i=function(){var t=this,e=t.$createElement;t._self._c},o=!1,d=[];i._withStripped=!0},137:function(t,e,n){"use strict";n.r(e);var a=n(138),i=n.n(a);for(var o in a)"default"!==o&&function(t){n.d(e,t,(function(){return a[t]}))}(o);e["default"]=i.a},138:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=u(n(9)),i=u(n(103)),o=u(n(104)),d=n(92),s=n(46),c=n(67),r=u(n(81));function u(t){return t&&t.__esModule?t:{default:t}}function l(t,e,n,a,i,o,d){try{var s=t[o](d),c=s.value}catch(r){return void n(r)}s.done?e(c):Promise.resolve(c).then(a,i)}function h(t){return function(){var e=this,n=arguments;return new Promise((function(a,i){var o=t.apply(e,n);function d(t){l(o,a,i,d,s,"next",t)}function s(t){l(o,a,i,d,s,"throw",t)}d(void 0)}))}}var m=function(){Promise.all([n.e("common/vendor"),n.e("components/release/release")]).then(function(){return resolve(n(373))}.bind(null,n)).catch(n.oe)},f=function(){n.e("components/audio/audioplay").then(function(){return resolve(n(301))}.bind(null,n)).catch(n.oe)},p=function(){n.e("components/dropball/dropball").then(function(){return resolve(n(292))}.bind(null,n)).catch(n.oe)},g={components:{musicAudio:f,release:m,dropball:p},data:function(){return{list:[{name:"邀请的试音",id:1},{name:"报价与付款",id:2},{name:"交付与验收",id:3}],consultantShow:!1,consultantTitle:"截图加我微信，获取更多试音",play:"https://www.peiyinstreet.com/guidang/play.png",playActive:"https://www.peiyinstreet.com/guidang/palyActive.png",shouchang:i.default,yishouchang:o.default,current:0,countSta:1,loadingmatchingShow:!0,background:{backgroundColor:"#ffffff"},timestamp:86400,InvitedPopShow:!1,confirmPopShow:!1,barStyle:{},priceList:["不限","中级≤20元","高级30元-40元","特级≥50元"],activeIndex:0,recommendedShow:!1,anShow:!0,demand_id:"",needType:"",demandProfile:{},recommended:{demand_id:this.demand_id,type:1,page:1,size:3},audioShow:!1,has_next:"",dataPlay:{url:""},recommendedData:[],beConfirmedData:[],invitationCount:0,invitationStatus:0,totalNum:0,listData:[],listObj:{demand_id:"",status:1},iphonestatus:!0,order_item:null,dataCode:"",demandState:!0,enddemandShow:!1,submitShow:!1,teachrID:"",statusNum:0,teacher_count:0,collectShow:!1,operationItem:{}}},onLoad:function(t){var e=this;console.log("传过来的id",t),setTimeout((function(){e.loadingmatchingShow=!1}),3e3),this.demand_id=t.id,this.recommended.demand_id=t.id,this.listObj.demand_id=t.id,this.needType=t.status,t.status&&(this.listObj.status=t.status,this.current=t.status),this.getDemandDetail(),this.getloginStatus(),this.getDemandDemandteacher()},onUnload:function(){},onShow:function(){var e=this;t.login({provider:"weixin",success:function(){var t=h(a.default.mark((function t(n){return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.dataCode=n.code;case 1:case"end":return t.stop()}}),t)})));function n(e){return t.apply(this,arguments)}return n}(),fail:function(t){console.log("登录失败",t)}})},onHide:function(){this.musicClose(),this.$store.commit("user/setDemandcate",this.demandProfile.cate),console.log("页面手动滑出会走这里吗")},methods:{getloginStatus:function(){var t=this;(0,s.loginStatus)().then((function(e){console.log("登录状态",e),0==e.data.phone?t.iphonestatus=!1:t.iphonestatus=!0}))},getDemandDetail:function(){var t=this;(0,d.demandDetail)({demand_id:this.demand_id}).then((function(e){t.demandProfile=e.data,t.teacher_count=e.data.demanddata,t.getDemandDetailteacher(),t.getlsitData(t.listObj),e.status,t.recommendedShow=!1,t.invitationStatus=e.status}))},handleVisitorsJump:function(e){e&&t.navigateTo({url:"/subpkg/pages/teacherlist/teacherlist?id="+e})},getDemandDetailteacher:function(){var t=this;(0,d.demandDetailteacher)({demand_id:this.demand_id}).then((function(e){t.invitationCount=e.data.length,t.beConfirmedData=e.data}))},handleConfirmInviteshow:function(){this.confirmPopShow=!0},handleviewInviteshow:function(){this.current=0,this.listObj.status=0,this.getlsitData(this.listObj)},handleShowerweima:function(t){this.consultantTitle="联系"===t?"截图加我微信，找我咨询下单":"截图加我微信，获取更多试音",this.consultantShow=!0},handleruku:function(){t.previewImage({urls:["https://www.peiyinstreet.com/guidang/peiyinguwen.png"],longPressActions:{itemList:["发送给朋友","保存图片","收藏"],success:function(t){console.log("选中了第"+(t.tapIndex+1)+"个按钮,第"+(t.index+1)+"张图片")},fail:function(t){console.log(t.errMsg)}}})},handlePlaceOrder:function(t){console.log("点击配音师的的id",t),this.teachrID=t.teacher_id,this.demandProfile.teacher_id=t.teacher_id,this.demandProfile.filename=t.title,this.demandProfile.content_url_escape=t.url,this.submitShow=!0},getsubmitShow:function(){this.submitShow=!1},handleConfirmInvite:function(){var e=this;(0,d.demandConfirm)({demand_id:this.demand_id}).then((function(n){e.confirmPopShow=!1,(0,d.demandFabulouslist)({demand_id:e.demand_id,status:0}).then((function(n){n.data.map((function(n){var a="teacher_"+n.teacher_id,i="";e.demandProfile.tags.map((function(t,e){i+=2===e?t.value:t.value+"-"}));var o=t.$TUIKit.createCustomMessage({to:a,conversationType:"C2C",payload:{data:"demand",description:e.demandProfile.audition_text,extension:JSON.stringify({audition_text:e.demandProfile.audition_text,content:e.demandProfile.content,tags:i,demand_id:e.demand_id})}});console.log("配音师需求发送消息",o),e.$sendTIMMessage(o)}))})),e.getDemandDetail()}))},handleDidnInvite:function(){t.showToast({title:"您还没有邀请的配音师哦",icon:"none",duration:2e3})},handleOperation:function(t){this.operationItem=t,this.collectShow=!0,console.log("点击操作打印数据",t,this.operationItem)},hanldeCancelcoll:function(){this.collectShow=!1},handleCollectStatus:function(){var t=this,e={work_id:this.operationItem.id,type:this.operationItem.work_type};(0,c.collection)(e).then((function(e){console.log(e),1===t.operationItem.work_type?t.operationItem.work_type=0:t.operationItem.work_type=1})).catch((function(t){}))},getDemandDemandteacher:function(){var t=this;(0,d.demandDemandteacher)(this.recommended).then((function(e){console.log("智能推荐弹窗",e),0==e.teacher_count?(t.totalNum=0,t.recommendedData=e.data):(t.totalNum=Math.ceil(e.teacher_count/3),t.recommendedData=e.data)}))},demandFabulousadd:function(e,n){var a=this;0===n?(0,d.demandFabulousadd)({demand_id:this.demand_id,service_id:e.id}).then((function(n){t.showToast({title:"已为您添加到【收藏的样音】里，\r\n可在需求详情页查看",icon:"none",duration:2e3}),a.recommendedData.map((function(t){e.teacher_id===t.teacher_id&&(t.fabulous_status=1)}))})):(0,d.demandFabulousdel)({demand_id:this.demand_id,service_id:e.id}).then((function(n){t.showToast({title:"取消收藏成功",icon:"none",duration:2e3}),a.recommendedData.map((function(t){e.teacher_id===t.teacher_id&&(t.fabulous_status=0)})),a.getlsitData(a.listObj)}))},handleInbatch:function(){this.recommended.page>=Math.ceil(this.totalNum)?this.recommended.page=1:this.recommended.page+=1,this.getDemandDemandteacher()},invitationConfirm:function(){this.recommendedShow=!1,this.getlsitData(this.listObj)},handleInvite:function(){this.invitationStatus?this.recommendedShow=!1:t.showToast({title:"你已确认邀请",icon:"none",duration:2e3})},handleInvitedAudition:function(e){var n=this;this.invitationStatus?(0,d.demandAdd)({service_id:e.id,demand_id:this.demand_id}).then((function(e){t.showToast({title:"谢谢邀请，确认后我会在10分钟内，\r\n快速出试音并上传哦",icon:"none",duration:2e3}),n.getDemandDemandteacher(),n.getDemandDetailteacher()})).catch((function(e){t.showToast({title:"每个需求最多可邀请3位试音哦\r\n快点击上方【去确认】吧",icon:"none",duration:2e3})})):t.showToast({title:"你已确认邀请",icon:"none",duration:2e3})},handleDemandDel:function(t){var e=this;(0,d.demandDel)({service_id:t.id,demand_id:this.demand_id}).then((function(t){e.getDemandDemandteacher(),e.getDemandDetailteacher()})).catch((function(t){console.log(t)}))},handleanorPack:function(){this.anShow=!this.anShow},handleShareAudition:function(){t.navigateTo({url:"/subpkg/pages/cloudshare/cloudshare?current=1&demand_id="+this.demand_id})},getlsitData:function(t){var e=this;(0,d.demandFabulouslist)(t).then((function(n){console.log("获取列表数据",n),e.current=t.status,e.countSta=n.count,console.log("获取列表数据",e.countSta,t.count),e.listData=n.data}))},change:function(t){this.listObj.status=t,this.getlsitData(this.listObj)},handlecloseerPopShow:function(){this.InvitedPopShow=!1,this.confirmPopShow=!1,this.consultantShow=!1,this.enddemandShow=!1},handlechangehome:function(t){this.InvitedPopShow=!0,this.order_item=t},handleEndDemand:function(){this.enddemandShow=!0},handleenddomanreq:function(){var t=this;(0,d.demandEnd)({demand_id:this.demand_id}).then((function(e){t.demandProfile.status=1,t.enddemandShow=!1})).catch((function(t){}))},handlefinishedMsg:function(){var t=this;(0,d.orderConfirm)({order_id:this.order_item.order_id}).then((function(e){console.log(e),t.InvitedPopShow=!1,t.finishedPayment(t.order_item),t.getDemandDetail()}))},finishedPayment:function(e){e.teacher_id;var n="teacher_"+e.teacher_id,a=t.$TUIKit.createCustomMessage({to:n,conversationType:"C2C",payload:{data:"finished",description:e.works[0].title,extension:JSON.stringify({title:e.works[0].title,timelength:e.works[0].duration,demand_id:this.demand_id,url:e.works[0].url,state:1,msg:e.works[0]})}});this.$sendTIMMessage(a)},handlePriceScreening:function(t){this.activeIndex=t,this.recommended.page=1,this.recommended.type=t+1,this.getDemandDemandteacher()},hanldeOrderPay:function(e){var n=this;(0,d.orderPay)({order_id:e.order_id}).then((function(a){console.log("支付返回参数",a);var i=n;t.requestPayment({provider:"wxpay",timeStamp:a.data.timeStamp,nonceStr:a.data.nonceStr,package:a.data.package,signType:a.data.signType,paySign:a.data.paySign,success:function(t){console.log("success:"+JSON.stringify(t)),i.getlsitData(i.listObj),i.orderPayment(e)},fail:function(t){console.log("fail:"+JSON.stringify(t)),i.getlsitData(i.listObj)}})}))},handleRoute:function(e){var n="C2Cteacher_"+e;console.log(e,n);var a="/subpkg/pages/chatpage/chatpage?conversationID=".concat(n);t.redirectTo({url:a})},onConversationListUpdated:function(t){this.setData({conversationList:t.data})},handleTaOrder:function(e){var n="C2Cteacher_"+e,a="/subpkg/pages/chatpage/chatpage?conversationID=".concat(n);t.redirectTo({url:a})},orderPayment:function(e){e.teacher_id;var n="teacher_"+e.teacher_id,a=t.$TUIKit.createCustomMessage({to:n,conversationType:"C2C",payload:{data:"order",description:this.demandProfile.audition_text,extension:JSON.stringify({title:this.demandProfile.audition_text,price:e.pay_price,delivery:e.delivery_timeout_time,demand_id:this.demand_id,pay_state:1})}});this.$sendTIMMessage(a)},$sendTIMMessage:function(e){this.$emit("sendMessage",{detail:{message:e}}),t.$TUIKit.sendMessage(e),this.setData({displayFlag:""})},playTheMusic:function(t){var e=this;console.log("传过来的数据",t,this.recommendedData),this.audioShow=!0,this.dataPlay.url===t.url?(this.recommendedData.map((function(n){e.dataPlay===n?t.playStatus=!t.playStatus:n.playStatus=!1})),this.beConfirmedData.map((function(n){e.dataPlay===n?t.playStatus=!t.playStatus:n.playStatus=!1})),this.listData.map((function(n){e.dataPlay===n?t.playStatus=!t.playStatus:n.playStatus=!1}))):(this.recommendedData.map((function(t){t.playStatus=!1})),this.beConfirmedData.map((function(t){t.playStatus=!1})),this.listData.map((function(t){t.playStatus=!1})),t.playStatus=!0,this.dataPlay=t),setTimeout((function(){e.$refs.musicAudio.preStartPlay()}),0)},handleChangePlay:function(t){var e=this;console.log("走这里没有",t),this.recommendedData.map((function(n){e.dataPlay===n?n.playStatus=t:n.playStatus=!1})),this.beConfirmedData.map((function(n){e.dataPlay===n?n.playStatus=t:n.playStatus=!1})),this.listData.map((function(n){e.dataPlay===n?n.playStatus=t:n.playStatus=!1}))},musicClose:function(){this.recommendedData.map((function(t){t.playStatus=!1})),this.beConfirmedData.map((function(t){t.playStatus=!1})),this.listData.map((function(t){t.playStatus=!1})),this.audioShow=!1,this.dataPlay={url:""}},onGetPhoneNumber:function(e){var n=this;if(console.log("微信小程序id",e,this.phonebb,this.phoneNumber),e.detail.cloudID){var a={iv:e.detail.iv,code:this.dataCode,encryptedData:e.detail.encryptedData};(0,d.getphone)(a).then((function(t){console.log("手机号请求数据",t.data);var e={nickname:"",userId:"",avatar:"",phone:t.data};(0,s.profileUpdate)(e).then((function(t){n.getloginStatus()})),n.confirmPopShow=!0})).catch((function(t){console.log("手机号请求数据",t)}))}else t.showToast({title:"请先授权手机号\r\n，否则无法试音哦",icon:"none",mask:!0,duration:2e3})},handleGoBack:function(){console.log("返回上一页",this.demandProfile.cate),this.$store.commit("user/setDemandcate",this.demandProfile.cate),t.switchTab({url:"/pages/demand/demand"})},downloadcopy:function(e,n){console.log("下载传过来的url",e),(0,r.default)({content:e,success:function(e){t.showToast({title:n,icon:"none"})},error:function(t){}})},startmessage:function(){},completemessage:function(t){console.log("联系我回调",t)}}};e.default=g}).call(this,n(1)["default"])},139:function(t,e,n){"use strict";n.r(e);var a=n(140),i=n.n(a);for(var o in a)"default"!==o&&function(t){n.d(e,t,(function(){return a[t]}))}(o);e["default"]=i.a},140:function(t,e,n){},141:function(t,e,n){"use strict";n.r(e);var a=n(142),i=n.n(a);for(var o in a)"default"!==o&&function(t){n.d(e,t,(function(){return a[t]}))}(o);e["default"]=i.a},142:function(t,e,n){}},[[133,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../../.sourcemap/mp-weixin/subpkg/pages/demanddetails/demanddetails.js.map