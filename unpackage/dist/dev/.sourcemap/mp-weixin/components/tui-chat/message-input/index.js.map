{"version":3,"sources":["webpack:////Users/elliott/Desktop/dubbingStr2.0/components/tui-chat/message-input/index.vue?8c5f","webpack:////Users/elliott/Desktop/dubbingStr2.0/components/tui-chat/message-input/index.vue?63a2","webpack:////Users/elliott/Desktop/dubbingStr2.0/components/tui-chat/message-input/index.vue?e0e5","webpack:////Users/elliott/Desktop/dubbingStr2.0/components/tui-chat/message-input/index.vue?6289","uni-app:///components/tui-chat/message-input/index.vue","webpack:////Users/elliott/Desktop/dubbingStr2.0/components/tui-chat/message-input/index.vue?048c"],"names":["renderjs","component","options","__file","components","render","_vm","this","_h","$createElement","_self","_c","recyclableRender","staticRenderFns","_withStripped","data","inputText","extensionArea","sendMessageBtn","displayFlag","isAudio","bottomVal","startPoint","popupToggle","isRecording","canSend","text","title","notShow","isShow","recordTime","recordTimer","commonFunction","name","key","displayServiceEvaluation","displayCommonWords","displayOrderList","TUIEmoji","TUICommonWords","TUIOrderList","TUIServiceEvaluation","props","conversation","type","Object","default","watch","handler","immediate","deep","beforeMount","recorderManager","uni","getRecorderManager","onStop","clearInterval","duration","res","tempFilePath","fileSize","hideLoading","msg","showToast","icon","to","conversationType","payload","file","methods","switchAudio","setData","handleLongPress","start","sampleRate","numberOfChannels","encodeBitRate","format","e","touches","setInterval","handleTouchMove","clientY","length","handleTouchEnd","stop","handleEmoji","targetFlag","handleExtensions","error","console","log","detail","handleSendPicture","sendImageMessage","handleSendImage","chooseImage","sourceType","count","success","onProgress","message","percent","handleShootVideo","sendVideoMessage","handleSendVideo","chooseVideo","maxDuration","camera","handleCommonFunctions","target","dataset","function","handleSendOrder","appendMessage","getToAccount","conversationID","replace","handleCalling","$emit","userID","sendTextMessage","$sendTIMMessage","onInputValueChange","event","value","$handleSendTextMessage","$handleSendCustomMessage","$handleCloseCards","$TUIKit","sendMessage","handleClose","handleServiceEvaluation","inputBindFocus","inputBindBlur"],"mappings":"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","file":"components/tui-chat/message-input/index.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./index.vue?vue&type=template&id=1da00aa0&\"\nvar renderjs\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"components/tui-chat/message-input/index.vue\"\nexport default component.exports","export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=template&id=1da00aa0&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"","<template>\n<view>\n<view class=\"TUI-message-input-container\">\n    <view class=\"TUI-commom-function\">\n        <view v-for=\"(item, index) in commonFunction\" :key=\"index\" class=\"TUI-commom-function-item\" :data-function=\"item\" @tap=\"handleCommonFunctions\">{{item.name}}</view>\n    </view>\n    <view class=\"TUI-message-input\">\n        <image class=\"TUI-icon\" @tap=\"switchAudio\" :src=\"isAudio ? '/static/static/assets/keyboard.svg' : '/static/static/assets/audio.svg'\"></image>\n        <view v-if=\"!isAudio\" class=\"TUI-message-input-main\">\n            <input class=\"TUI-message-input-area\" :adjust-position=\"true\" cursor-spacing=\"20\" v-model=\"inputText\" @input=\"onInputValueChange\" maxlength=\"140\" type=\"text\"  placeholder-class=\"input-placeholder\" placeholder=\"说点什么呢~\" @focus=\"inputBindFocus\" @blur=\"inputBindBlur\">\n        </view>\n        <view v-else class=\"TUI-message-input-main\" @longpress=\"handleLongPress\" @touchmove=\"handleTouchMove\" @touchend=\"handleTouchEnd\" style=\"display: flex; justify-content: center; font-size: 32rpx; font-family: PingFangSC-Regular;\">\n            <text>{{text}}</text>\n        </view>\n        <view class=\"TUI-message-input-functions\" hover-class=\"none\">\n            <image class=\"TUI-icon\" @tap=\"handleEmoji\" src=\"/static/static/assets/face-emoji.svg\"></image>\n            <view v-if=\"!sendMessageBtn\" @tap=\"handleExtensions\">\n                <image class=\"TUI-icon\" src=\"/static/static/assets/more.svg\"></image>\n            </view>\n            <view v-else class=\"TUI-sendMessage-btn\" @tap=\"sendTextMessage\">\n                发送\n            </view>\n        </view>\n    </view>\n    <view v-if=\"displayFlag === 'emoji'\" class=\"TUI-Emoji-area\">\n        <TUI-Emoji @enterEmoji=\"appendMessage\"></TUI-Emoji>\n    </view>\n    <view v-if=\"displayFlag === 'extension'\" class=\"TUI-Extensions\">\n        <!-- TODO: 这里功能还没实现 -->\n<!--        <camera device-position=\"back\" flash=\"off\" binderror=\"error\" style=\"width: 100%; height: 300px;\"></camera>-->\n        <view class=\"TUI-Extension-slot\" @tap=\"handleSendPicture\">\n            <image class=\"TUI-Extension-icon\" src=\"/static/static/assets/take-photo.svg\"></image>\n            <view class=\"TUI-Extension-slot-name\">拍摄照片</view>\n        </view>\n        <view class=\"TUI-Extension-slot\" @tap=\"handleSendImage\">\n            <image class=\"TUI-Extension-icon\" src=\"/static/static/assets/send-img.svg\"></image>\n            <view class=\"TUI-Extension-slot-name\">发送图片</view>\n        </view>\n        <view class=\"TUI-Extension-slot\" @tap=\"handleShootVideo\">\n            <image class=\"TUI-Extension-icon\" src=\"/static/static/assets/take-video.svg\"></image>\n            <view class=\"TUI-Extension-slot-name\">拍摄视频</view>\n        </view>\n                <view class=\"TUI-Extension-slot\" @tap=\"handleSendVideo\">\n            <image class=\"TUI-Extension-icon\" src=\"/static/static/assets/send-video.svg\"></image>\n            <view class=\"TUI-Extension-slot-name\">发送视频</view>\n        </view>\n     <!--   <view class=\"TUI-Extension-slot\" :data-value=\"1\" @tap=\"handleCalling\">\n            <image class=\"TUI-Extension-icon\" src=\"/static/static/assets/audio-calling.svg\"></image>\n            <view class=\"TUI-Extension-slot-name\">语音通话</view>\n        </view>\n        <view class=\"TUI-Extension-slot\" :data-value=\"2\" @tap=\"handleCalling\">\n            <image class=\"TUI-Extension-icon\" src=\"/static/static/assets/video-calling.svg\"></image>\n            <view class=\"TUI-Extension-slot-name\">视频通话</view>\n        </view> -->\n        <view class=\"TUI-Extension-slot\" @tap=\"handleServiceEvaluation\">\n            <image class=\"TUI-Extension-icon\" src=\"/static/static/assets/service-assess.svg\"></image>\n            <view class=\"TUI-Extension-slot-name\">服务评价</view>\n        </view>\n        <view class=\"TUI-Extension-slot\" @tap=\"handleSendOrder\">\n            <image class=\"TUI-Extension-icon\" src=\"/static/static/assets/send-order.svg\"></image>\n            <view class=\"TUI-Extension-slot-name\">发送订单</view>\n        </view>\n    </view>\n    <TUI-Common-Words class=\"tui-cards\" :display=\"displayCommonWords\" @sendMessage=\"$handleSendTextMessage\" @close=\"$handleCloseCards\"></TUI-Common-Words>\n    <TUI-Order-List class=\"tui-cards\" :display=\"displayOrderList\" @sendCustomMessage=\"$handleSendCustomMessage\" @close=\"$handleCloseCards\"></TUI-Order-List>\n    <TUI-Service-Evaluation class=\"tui-cards\" :display=\"displayServiceEvaluation\" @sendCustomMessage=\"$handleSendCustomMessage\" @close=\"$handleCloseCards\"></TUI-Service-Evaluation>\n</view>\n<view class=\"record-modal\" v-if=\"popupToggle\" @longpress=\"handleLongPress\" @touchmove=\"handleTouchMove\" @touchend=\"handleTouchEnd\">\n    <view class=\"wrapper\">\n        <view class=\"modal-loading\">\n        </view>\n    </view>\n    <view class=\"modal-title\">\n    {{title}}\n    </view>\n</view>\n</view>\n</template>\n\n<script>\nimport TUIEmoji from \"../message-elements/emoji/index\";\nimport TUICommonWords from \"../message-private/common-words/index\";\nimport TUIOrderList from \"../message-private/order-list/index\";\nimport TUIServiceEvaluation from \"../message-private/service-evaluation/index\";\n\nexport default {\n  data() {\n    return {\n      // todo  conversation\n      // conversation: {},\n      inputText: '',\n      extensionArea: false,\n      sendMessageBtn: false,\n      displayFlag: '',\n      isAudio: false,\n      bottomVal: 0,\n      startPoint: 0,\n      popupToggle: false,\n      isRecording: false,\n      canSend: true,\n      text: '按住说话',\n      title: ' ',\n      notShow: false,\n      isShow: true,\n      recordTime: 0,\n      recordTimer: null,\n      commonFunction: [{\n        name: '常用语',\n        key: '0'\n      }, {\n        name: '发送订单',\n        key: '1'\n      }, {\n        name: '服务评价',\n        key: '2'\n      }],\n      displayServiceEvaluation: false,\n      displayCommonWords: false,\n      displayOrderList: false\n    };\n  },\n\n  components: {\n    TUIEmoji,\n    TUICommonWords,\n    TUIOrderList,\n    TUIServiceEvaluation\n  },\n  props: {\n    conversation: {\n      type: Object,\n      default: () => {}\n    }\n  },\n  watch: {\n    conversation: {\n      handler: function (newVal) {\n        // todo 值会被改变\n        // this.setData({\n        //   conversation: newVal\n        // });\n      },\n      immediate: true,\n      deep: true\n    }\n  },\n\n  beforeMount() {\n    // 加载声音录制管理器\n    this.recorderManager = uni.getRecorderManager();\n    this.recorderManager.onStop(res => {\n      clearInterval(this.recordTimer);\n      // 兼容 uniapp 打包app，duration 和 fileSize 需要用户自己补充\n      // 文件大小 ＝ (音频码率) x 时间长度(单位:秒) / 8\n      let msg = {\n        duration: res.duration? res.duration : this.recordTime * 1000,\n        tempFilePath: res.tempFilePath,\n        fileSize: res.fileSize ? res.fileSize : (48 * this.recordTime) / 8 * 1024\n      }\n      uni.hideLoading();\n      // 兼容 uniapp 语音消息没有duration\n      if (this.canSend) {\n        if (msg.duration < 1000) {\n          uni.showToast({\n            title: '录音时间太短',\n            icon: 'none'\n          });\n        } else {\n          // res.tempFilePath 存储录音文件的临时路径\n          const message = uni.$TUIKit.createAudioMessage({\n            to: this.getToAccount(),\n            conversationType: this.conversation.type,\n            payload: {\n              file: msg\n            }\n          });\n          this.$sendTIMMessage(message);\n        }\n      }\n\n      this.setData({\n        startPoint: 0,\n        popupToggle: false,\n        isRecording: false,\n        canSend: true,\n        title: ' ',\n        text: '按住说话'\n      });\n    });\n  },\n\n  methods: {\n    switchAudio() {\n      this.setData({\n        isAudio: !this.isAudio,\n        text: '按住说话'\n      });\n    },\n\n    handleLongPress(e) {\n      this.recorderManager.start({\n        duration: 60000,\n        // 录音的时长，单位 ms，最大值 600000（10 分钟）\n        sampleRate: 44100,\n        // 采样率\n        numberOfChannels: 1,\n        // 录音通道数\n        encodeBitRate: 192000,\n        // 编码码率\n        format: 'aac' // 音频格式，选择此格式创建的音频消息，可以在即时通信 IM 全平台（Android、iOS、微信小程序和Web）互通\n\n      });\n      this.setData({\n        startPoint: e.touches[0],\n        title: '正在录音',\n        // isRecording : true,\n        // canSend: true,\n        notShow: true,\n        isShow: false,\n        isRecording: true,\n        popupToggle: true,\n        recordTime: 0\n      });\n      this.recordTimer = setInterval(() => {\n        this.recordTime++;\n      }, 1000)\n    },\n\n    // 录音时的手势上划移动距离对应文案变化\n    handleTouchMove(e) {\n      if (this.isRecording) {\n        if (this.startPoint.clientY - e.touches[e.touches.length - 1].clientY > 100) {\n          this.setData({\n            text: '抬起停止',\n            title: '松开手指，取消发送',\n            canSend: false\n          });\n        } else if (this.startPoint.clientY - e.touches[e.touches.length - 1].clientY > 20) {\n          this.setData({\n            text: '抬起停止',\n            title: '上划可取消',\n            canSend: true\n          });\n        } else {\n          this.setData({\n            text: '抬起停止',\n            title: '正在录音',\n            canSend: true\n          });\n        }\n      }\n    },\n\n    // 手指离开页面滑动\n    handleTouchEnd() {\n      this.setData({\n        isRecording: false,\n        popupToggle: false\n      });\n      uni.hideLoading();\n      this.recorderManager.stop();\n    },\n    handleEmoji() {\n      let targetFlag = 'emoji';\n\n      if (this.displayFlag === 'emoji') {\n        targetFlag = '';\n      }\n\n      this.setData({\n        displayFlag: targetFlag\n      });\n    },\n\n    handleExtensions() {\n      let targetFlag = 'extension';\n\n      if (this.displayFlag === 'extension') {\n        targetFlag = '';\n      }\n\n      this.setData({\n        displayFlag: targetFlag\n      });\n    },\n\n    error(e) {\n      console.log(e.detail);\n    },\n\n    handleSendPicture() {\n      this.sendImageMessage('camera');\n    },\n\n    handleSendImage() {\n      this.sendImageMessage('album');\n    },\n\n    sendImageMessage(type) {\n      uni.chooseImage({\n        sourceType: [type],\n        count: 1,\n        success: res => {\n          if (res) {\n            const message = uni.$TUIKit.createImageMessage({\n              to: this.getToAccount(),\n              conversationType: this.conversation.type,\n              payload: {\n                file: res\n              },\n              onProgress: percent => {\n                message.percent = percent;\n              }\n            });\n            this.$sendTIMMessage(message);\n          }\n        }\n      });\n    },\n\n    handleShootVideo() {\n      this.sendVideoMessage('camera');\n    },\n\n    handleSendVideo() {\n      this.sendVideoMessage('album');\n    },\n\n    sendVideoMessage(type) {\n      uni.chooseVideo({\n        sourceType: [type],\n        // 来源相册或者拍摄\n        maxDuration: 60,\n        // 设置最长时间60s\n        camera: 'back',\n        // 后置摄像头\n        success: res => {\n          if (res) {\n            const message = uni.$TUIKit.createVideoMessage({\n              to: this.getToAccount(),\n              conversationType: this.conversation.type,\n              payload: {\n                file: res\n              },\n              onProgress: percent => {\n                message.percent = percent;\n              }\n            });\n            this.$sendTIMMessage(message);\n          }\n        }\n      });\n    },\n\n    handleCommonFunctions(e) {\n      switch (e.target.dataset.function.key) {\n        case '0':\n          this.setData({\n            displayCommonWords: true\n          });\n          break;\n\n        case '1':\n          this.setData({\n            displayOrderList: true\n          });\n          break;\n\n        case '2':\n          this.setData({\n            displayServiceEvaluation: true\n          });\n          break;\n\n        default:\n          break;\n      }\n    },\n\n    handleSendOrder() {\n      this.setData({\n        displayOrderList: true\n      });\n    },\n\n    appendMessage(e) {\n      this.setData({\n        inputText: this.inputText + e.detail.message,\n        sendMessageBtn: true\n      });\n    },\n\n    getToAccount() {\n      if (!this.conversation || !this.conversation.conversationID) {\n        return '';\n      }\n\n      switch (this.conversation.type) {\n        case 'C2C':\n          return this.conversation.conversationID.replace('C2C', '');\n\n        case 'GROUP':\n          return this.conversation.conversationID.replace('GROUP', '');\n\n        default:\n          return this.conversation.conversationID;\n      }\n    },\n\n    handleCalling(e) {\n      // todo 目前支持单聊\n      if (this.conversation.type === 'GROUP') {\n        uni.showToast({\n          title: '群聊暂不支持',\n          icon: 'none'\n        });\n        return;\n      }\n\n      const type = e.currentTarget.dataset.value;\n      const {\n        userID\n      } = this.conversation.userProfile;\n      this.$emit('handleCall', {\n        detail: {\n          type,\n          userID\n        }\n      });\n      this.setData({\n        displayFlag: ''\n      });\n    },\n\n    sendTextMessage(msg, flag) {\n      const to = this.getToAccount();\n      const text = flag ? msg : this.inputText;\n      const message = uni.$TUIKit.createTextMessage({\n        to,\n        conversationType: this.conversation.type,\n        payload: {\n          text\n        }\n      });\n      this.setData({\n        inputText: '',\n        sendMessageBtn: false\n      });\n      this.$sendTIMMessage(message);\n    },\n\n    onInputValueChange(event) {\n      if (event.detail.value) {\n        this.setData({\n          sendMessageBtn: true\n        });\n      } else {\n        this.setData({\n          sendMessageBtn: false\n        });\n      }\n    },\n\n    $handleSendTextMessage(event) {\n      this.sendTextMessage(event.detail.message, true);\n      this.setData({\n        displayCommonWords: false\n      });\n    },\n\n    $handleSendCustomMessage(e) {\n      const message = uni.$TUIKit.createCustomMessage({\n        to: this.getToAccount(),\n        conversationType: this.conversation.type,\n        payload: e.detail.payload\n      });\n      this.$sendTIMMessage(message);\n      this.setData({\n        displayOrderList: false\n      });\n    },\n\n    $handleCloseCards(e) {\n      switch (e.detail.key) {\n        case '0':\n          this.setData({\n            displayCommonWords: false\n          });\n          break;\n\n        case '1':\n          this.setData({\n            displayOrderList: false\n          });\n          break;\n\n        case '2':\n          this.setData({\n            displayServiceEvaluation: false\n          });\n          break;\n\n        default:\n          break;\n      }\n    },\n\n    $sendTIMMessage(message) {\n      this.$emit('sendMessage', {\n        detail: {\n          message\n        }\n      });\n      uni.$TUIKit.sendMessage(message)\n      this.setData({\n        displayFlag: ''\n      });\n    },\n\n    handleClose() {\n      this.setData({\n        displayFlag: ''\n      });\n    },\n\n    handleServiceEvaluation() {\n      this.setData({\n        displayServiceEvaluation: true\n      });\n    },\n\n    inputBindFocus() {\n      console.log(\"占位：函数 inputBindFocus 未声明\");\n    },\n\n    inputBindBlur() {\n      console.log(\"占位：函数 inputBindBlur 未声明\");\n    }\n\n  }\n};\n</script>\n<style>\n@import \"./index.css\";\n</style>\n","import mod from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=style&index=0&lang=css&\""],"sourceRoot":""}