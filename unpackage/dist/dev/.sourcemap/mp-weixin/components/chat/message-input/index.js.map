{"version":3,"sources":["webpack:////Users/elliott/Desktop/dubbingStr2.0/components/chat/message-input/index.vue?134e","webpack:////Users/elliott/Desktop/dubbingStr2.0/components/chat/message-input/index.vue?7817","webpack:////Users/elliott/Desktop/dubbingStr2.0/components/chat/message-input/index.vue?5fa9","webpack:////Users/elliott/Desktop/dubbingStr2.0/components/chat/message-input/index.vue?14e8","uni-app:///components/chat/message-input/index.vue","webpack:////Users/elliott/Desktop/dubbingStr2.0/components/chat/message-input/index.vue?d2ad"],"names":["renderjs","component","options","__file","components","lFile","e","message","indexOf","console","error","render","_vm","this","_h","$createElement","_self","_c","recyclableRender","staticRenderFns","_withStripped","data","inputText","extensionArea","sendMessageBtn","isAudio","bottomVal","startPoint","popupToggle","isRecording","canSend","text","title","notShow","isShow","recordTime","recordTimer","commonFunction","name","key","displayCommonWords","displayOrderList","TUIEmoji","TUIOrderList","props","conversation","type","Object","default","watch","handler","immediate","deep","beforeMount","methods","handleCommonFunctions","target","dataset","function","setData","onUpload","appendMessage","detail","getToAccount","conversationID","replace","sendTextMessage","log","to","conversationType","payload","$sendTIMMessage","onInputValueChange","event","value","$handleSendCustomMessage","$handleCloseCards","$emit","uni","$TUIKit","sendMessage","displayFlag","handleClose","inputBindFocus","inputBindBlur","fileSize"],"mappings":"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","file":"components/chat/message-input/index.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./index.vue?vue&type=template&id=b44302ea&\"\nvar renderjs\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"components/chat/message-input/index.vue\"\nexport default component.exports","export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=template&id=b44302ea&\"","var components\ntry {\n  components = {\n    lFile: function() {\n      return import(\n        /* webpackChunkName: \"uni_modules/l-file/components/l-file/l-file\" */ \"@/uni_modules/l-file/components/l-file/l-file.vue\"\n      )\n    }\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"","<template>\n<view>\n<view class=\"TUI-message-input-container\">\n    <view class=\"TUI-commom-function\">\n        <view v-for=\"(item, index) in commonFunction\" :key=\"index\" class=\"TUI-commom-function-item\" :data-function=\"item\" @tap=\"handleCommonFunctions\">{{item.name}}</view>\n    </view>\n    <view class=\"TUI-message-input\">\n        <view v-if=\"!isAudio\" class=\"TUI-message-input-main\">\n            <input class=\"TUI-message-input-area\" :adjust-position=\"true\" cursor-spacing=\"20\" v-model=\"inputText\" @input=\"onInputValueChange\" maxlength=\"140\" type=\"text\"  placeholder-class=\"input-placeholder\" placeholder=\"新消息...\" @focus=\"inputBindFocus\" @blur=\"inputBindBlur\">\n        </view>\n        <view class=\"send\" :class=\"isVoice?'hidden':''\" @tap=\"sendTextMessage\">\n              <view class=\"btn\">发送</view>\n        </view>\n    </view>\n    <view class=\"place_view\"></view>\n    <TUI-Order-List class=\"tui-cards\" :display=\"displayOrderList\" :conversation=\"conversation\" @sendCustomMessage=\"$handleSendCustomMessage\" @close=\"$handleCloseCards\"></TUI-Order-List>\n</view>\n<l-file ref=\"lFile\" :logo=\"logo\" @up-success=\"onSuccess\"></l-file>\n</view>\n</template>\n\n<script>\nimport TUIEmoji from \"../message-elements/emoji/index\";\nimport TUIOrderList from \"../message-private/order-list/index\";\n\nexport default {\n  data() {\n    return {\n      // todo  conversation\n      // conversation: {},\n      inputText: '',\n      extensionArea: false,\n      sendMessageBtn: false,\n      isAudio: false,\n      bottomVal: 0,\n      startPoint: 0,\n      popupToggle: false,\n      isRecording: false,\n      canSend: true,\n      text: '按住说话',\n      title: ' ',\n      notShow: false,\n      isShow: true,\n      recordTime: 0,\n      recordTimer: null,\n      commonFunction: [{\n        name: '请求报价',\n        key: '0'\n      }, {\n        name: '发送文件',\n        key: '1'\n      }],\n      displayCommonWords: false,\n      displayOrderList: false\n    };\n  },\n\n  components: {\n    TUIEmoji,\n    TUIOrderList\n  },\n  props: {\n    conversation: {\n      type: Object,\n      default: () => {}\n    }\n  },\n  watch: {\n    conversation: {\n      handler: function (newVal) {\n        // todo 值会被改变\n        // this.setData({\n        //   conversation: newVal\n        // });\n      },\n      immediate: true,\n      deep: true\n    }\n  },\n\n  beforeMount() {\n  },\n\n  methods: {\n\n    handleCommonFunctions(e) {\n      switch (e.target.dataset.function.key) {\n        case '0':\n          this.setData({\n            displayOrderList: true\n          });\n          break;\n\n        case '1': \n          this.onUpload()\n          break;\n\n        default:\n          break;\n      }\n    },\n\n    appendMessage(e) {\n      this.setData({\n        inputText: this.inputText + e.detail.message,\n        sendMessageBtn: true\n      });\n    },\n\n    getToAccount() {\n      if (!this.conversation || !this.conversation.conversationID) {\n        return '';\n      }\n\n      switch (this.conversation.type) {\n        case 'C2C':\n          return this.conversation.conversationID.replace('C2C', '');\n\n        case 'GROUP':\n          return this.conversation.conversationID.replace('GROUP', '');\n\n        default:\n          return this.conversation.conversationID;\n      }\n    },\n\n    sendTextMessage(msg, flag) {\n      const to = this.getToAccount();\n      console.log('发送的消息内容to', to)\n      const text = flag ? msg : this.inputText;\n      const message = uni.$TUIKit.createTextMessage({\n        to,\n        conversationType: this.conversation.type,\n        payload: {\n          text\n        }\n      });\n      this.setData({\n        inputText: '',\n        sendMessageBtn: false\n      });\n      this.$sendTIMMessage(message);\n    },\n\n    onInputValueChange(event) {\n      if (event.detail.value) {\n        this.setData({\n          sendMessageBtn: true\n        });\n      } else {\n        this.setData({\n          sendMessageBtn: false\n        });\n      }\n    },\n\n    $handleSendCustomMessage(e) {\n      console.log('发送的消息内容', e)\n      const message = uni.$TUIKit.createCustomMessage({\n        to: this.getToAccount(),\n        conversationType: this.conversation.type,\n        payload: e.detail.payload\n      });\n      this.$sendTIMMessage(message);\n      this.setData({\n        displayOrderList: false\n      });\n    },\n\n    $handleCloseCards(e) {\n      switch (e.detail.key) {\n        case '0':\n          this.setData({\n            displayOrderList: false\n          });\n          break;\n\n        default:\n          break;\n      }\n    },\n\n    $sendTIMMessage(message) {\n      this.$emit('sendMessage', {\n        detail: {\n          message\n        }\n      });\n      uni.$TUIKit.sendMessage(message)\n      this.setData({\n        displayFlag: ''\n      });\n    },\n\n    handleClose() {\n      this.setData({\n        displayFlag: ''\n      });\n    },\n    inputBindFocus() {\n      console.log(\"占位：函数 inputBindFocus 未声明\");\n    },\n    inputBindBlur() {\n      console.log(\"占位：函数 inputBindBlur 未声明\");\n    },\n     /* 上传 */\n\t\tonUpload() { \n\t\t\t\tlet platform =  uni.getSystemInfoSync().platform\n        if (platform == 'android' || platform == 'ios' || platform == 'devtools') {\n\t\t\t\t\tthis.$refs.lFile.upload({\n\t\t\t\t\t\t// #ifdef APP-PLUS\n\t\t\t\t\t\t// nvue页面使用时请查阅nvue获取当前webview的api，当前示例为vue窗口\n\t\t\t\t\t\tcurrentWebview: this.$mp.page.$getAppWebview(),\n\t\t\t\t\t\t// #endif\n\t\t\t\t\t\turl: \"https://www.peiyinstreet.com/business/chat/upload\", //替换为你的\n\t\t\t\t\t\tname: 'file',\n\t\t\t\t\t\theader: {  //根据你接口需求自定义\n\t\t\t\t\t\tuserToken: this.token || ''\t\n\t\t\t\t\t\t},\n\t\t\t\t\t\tformData: {\n\t\t\t\t\t\tfileName: '',\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t}else {\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: \"微信小程序仅支持从手机端上传\",\n\t\t\t\t\t\ticon: 'none',\n\t\t\t\t\t\tmask: true,\n\t\t\t\t\t\tduration: 3000\n\t\t\t\t\t});\n\t\t\t\t}\t\n\t\t\t},\n\t\t\tonSuccess(res) {\n        console.log('上传成功回调',JSON.stringify(res), res);\n        const size = this.formatFileSize(res.size)\n        this.$handleSendCustomMessage({detail: {\n            payload: {\n              // data 字段作为表示，可以自定义\n              data: 'file',\n              description: res.fileName,\n              // 获取骰子点数\n              extension: JSON.stringify({\n                fileName: res.fileName,\n                size: size,\n                url: res.data.data\n              })\n            }\n        }})\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle: '文件上传成功',\n\t\t\t\t\ticon: 'none'\n\t\t\t\t})\n\t\t\t},\n     formatFileSize(fileSize) {\n      if (fileSize < 1024) {\n          return fileSize + 'B';\n      } else if (fileSize < (1024*1024)) {\n          var temp = fileSize / 1024;\n          temp = temp.toFixed(2);\n          return temp + 'KB';\n      } else if (fileSize < (1024*1024*1024)) {\n          var temp = fileSize / (1024*1024);\n         temp = temp.toFixed(2);\n         return temp + 'MB';\n     } else {\n         var temp = fileSize / (1024*1024*1024);\n         temp = temp.toFixed(2);\n         return temp + 'GB';\n     }\n   }\n  }\n};\n</script>\n<style>\n@import \"./index.css\";\n</style>\n","import mod from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=style&index=0&lang=css&\""],"sourceRoot":""}