{"version":3,"sources":["webpack:////Users/elliott/Desktop/dubbingStr2.0/pages/TUI-Chat/chat.vue?2ee3","webpack:////Users/elliott/Desktop/dubbingStr2.0/pages/TUI-Chat/chat.vue?e101","webpack:////Users/elliott/Desktop/dubbingStr2.0/pages/TUI-Chat/chat.vue?97b3","uni-app:///pages/TUI-Chat/chat.vue","webpack:////Users/elliott/Desktop/dubbingStr2.0/pages/TUI-Chat/chat.vue?b4d1","uni-app:///main.js","webpack:////Users/elliott/Desktop/dubbingStr2.0/pages/TUI-Chat/chat.vue?3517"],"names":["components","render","_vm","this","_h","$createElement","_self","_c","recyclableRender","staticRenderFns","_withStripped","props","created","uni","$on","onLoad","setData","conversationID","$TUIKit","setMessageRead","getConversationProfile","then","conversationName","isShow","conversation","type","methods","stopVideoHander","videoPlay","getConversationName","showChat","remark","userProfile","nick","userID","groupProfile","name","groupID","sendMessage","$refs","messageList","updateMessageList","event","detail","message","triggerClose","messageInput","handleClose","goBack","pages","length","route","navigateBack","delta","wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","renderjs","component","options","__file"],"mappings":";;;;2GAAA,uxC;;;;2GCAA,IAAIA,EAAJ,0LACA,IAAIC,EAAS,WACX,IAAIC,EAAMC,KACNC,EAAKF,EAAIG,eACJH,EAAII,MAAMC,IAEjBC,GAAmB,EACnBC,EAAkB,GACtBR,EAAOS,eAAgB,G;;;;2DCRvB,03BAAm0B,eAAG,G;;;;0ICsBt0B,oC,ihBAIA,CACA,KADA,WAEA,OACA,oBACA,gBACA,eACA,UACA,YACA,kBACA,aACA,kBAIA,YACA,iBACA,mBAEEC,MAAO,GACPC,QAnBF,WAmBA,WACIC,EAAIC,IAAI,sBAAZ,YACM,EAAN,mBACM,EAAN,2BAOEC,OA7BF,SA6BA,cAEI,EAAJ,8EAFA,IAII,EACA,EADJ,eAEIZ,KAAKa,QAAQ,CACXC,eAAN,IAEIJ,EAAIK,QAAQC,eAAe,CACzBF,eAAN,IACI,MAAJ,WACM,EAAN,kDAEIJ,EAAIK,QAAQE,uBAAuBH,GAAgBI,MAAK,SAA5D,OAEM,EACA,EAAN,KADA,aAEM,EAAN,eACM,EAAN,SACQC,iBAAkB,EAA1B,uBACQC,OAA8B,UAAtBC,EAAaC,WAK3BC,QAAS,CACPC,gBADJ,WAEMxB,KAAKyB,WAAY,GAEnBC,oBAJJ,SAIA,GACM,MAA0B,gBAAtBL,EAAaC,MACftB,KAAKa,QAAQ,CACXc,UAAU,IAEL,QAGiB,QAAtBN,EAAaC,KACRD,EAAaO,QAAUP,EAAaQ,YAAYC,MAAQT,EAAaQ,YAAYE,OAGhE,UAAtBV,EAAaC,KACRD,EAAaW,aAAaC,MAAQZ,EAAaW,aAAaE,aADrE,GAKFC,YArBJ,SAqBA,GAEMnC,KAAKoC,MAAMC,YAAYC,kBAAkBC,EAAMC,OAAOC,UAGxDC,aA1BJ,WA2BA,eACQ1C,KAAKoC,MAAMO,aAAaC,eAI5BC,OAhCJ,WAiCM,IAAN,oBAE4C,sDAAlCC,EAAMA,EAAMC,OAAS,GAAGC,OAAmG,wCAAlCF,EAAMA,EAAMC,OAAS,GAAGC,OAAqF,oCAAlCF,EAAMA,EAAMC,OAAS,GAAGC,MAC9LtC,EAAIuC,aAAa,CACfC,MAAO,IAGTxC,EAAIuC,aAAa,CACfC,MAAO,IAIXxC,EAAIK,QAAQC,eAAe,CACzBF,eAAgBd,KAAKc,iBACvB,MAAN,kB;;;;2DChIA,iuCAA0qC,eAAG,G;;;;;;;;wECA7qC,qBACA,sBACA,2C,mDAFmBqC,GAAGC,kCAAoCC,EAG1DC,EAAWC,a;;;;2DCHX,qQACIC,EADJ,kMASIC,EAAY,qBACd,aACA,YACA,sBACA,EACA,KACA,KACA,MACA,EACA,gBACAD,GAGFC,EAAUC,QAAQC,OAAS,0BACZ,aAAAF,E","file":"pages/TUI-Chat/chat.js","sourcesContent":["export * from \"-!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./chat.vue?vue&type=template&id=5fe7757e&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./chat.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./chat.vue?vue&type=script&lang=js&\"","<template>\n<view class=\"container\">\n<!--  <TUI-calling class=\"calling\" id=\"tui-calling\" @sendMessage=\"sendMessage\"></TUI-calling>-->\n  <view class=\"tui-chatroom-navigatorbar\">\n    <image class=\"tui-chatroom-navigatorbar-back\" @tap=\"goBack\" src=\"/static/static/assets/ic_back_white.svg\"></image>\n    <!-- 先查 remark；无 remark 查 (c2c)nick/(group)name；最后查 (c2c)userID/(group)groupID -->\n    <view class=\"conversation-title\">{{conversationName}}</view>\n  </view>\n  <view class=\"message-list\" @tap=\"triggerClose\">\n    <TUI-message-list  ref=\"messageList\" id=\"message-list\" :conversation=\"conversation\"></TUI-message-list>\n  </view>\n  <view class=\"container-box\" v-if=\"videoPlay\" @tap.stop=\"stopVideoHander\">\n    <video class=\"video-message\" v-if=\"videoPlay\"  :src=\"videoMessage.payload.videoUrl\" :poster=\"videoMessage.payload.thumbUrl\" object-fit=\"cover\" error=\"videoError\" autoplay=\"true\" direction=\"0\">\n    </video>\n  </view>\n  <view class=\"message-input\" v-if=\"showChat\">\n    <TUI-message-input ref=\"messageInput\"  id=\"message-input\" :conversation=\"conversation\" @sendMessage=\"sendMessage\"></TUI-message-input>\n  </view>\n</view>\n</template>\n\n<script>\nimport logger from '@/utils/logger';\nimport TUIMessageList from \"@/components/tui-chat/message-list/index\";\nimport TUIMessageInput from \"@/components/tui-chat/message-input/index\";\n\nexport default {\n  data() {\n    return {\n      conversationName: '',\n      conversation: {},\n      messageList: [],\n      isShow: false,\n      showChat: true,\n      conversationID: '',\n      videoPlay: false,\n      videoMessage: {},\n    };\n  },\n\n  components: {\n    TUIMessageList,\n    TUIMessageInput\n  },\n  props: {},\n  created(){\n    uni.$on('videoPlayerHandler',(value)=>{\n      this.videoPlay = value.isPlay\n      this.videoMessage = value.message\n    })\n  },\n\n  /**\n   * 生命周期函数--监听页面加载\n   */\n  onLoad(options) {\n    // conversationID: C2C、 GROUP\n    logger.log(` TUI-chat | onLoad | conversationID: ${options.conversationID}`);\n    const {\n      conversationID\n    } = options;\n    this.setData({\n      conversationID\n    });\n    uni.$TUIKit.setMessageRead({\n      conversationID\n    }).then(() => {\n      logger.log('TUI-chat | setMessageRead  | ok');\n    });\n    uni.$TUIKit.getConversationProfile(conversationID).then(res => {\n      const {\n        conversation\n      } = res.data;\n      this.conversation = conversation\n      this.setData({\n        conversationName: this.getConversationName(conversation),\n        isShow: conversation.type === 'GROUP'\n      });\n    });\n  },\n\n  methods: {\n    stopVideoHander() {\n      this.videoPlay = false\n    },\n    getConversationName(conversation) {\n      if (conversation.type === '@TIM#SYSTEM') {\n        this.setData({\n          showChat: false\n        });\n        return '系统通知';\n      }\n\n      if (conversation.type === 'C2C') {\n        return conversation.remark || conversation.userProfile.nick || conversation.userProfile.userID;\n      }\n\n      if (conversation.type === 'GROUP') {\n        return conversation.groupProfile.name || conversation.groupProfile.groupID;\n      }\n    },\n\n    sendMessage(event) {\n      // 将自己发送的消息写进消息列表里面\n      this.$refs.messageList.updateMessageList(event.detail.message);\n    },\n\n    triggerClose() {\n      if(this.showChat) {\n        this.$refs.messageInput.handleClose();\n      }\n    },\n\n    goBack() {\n      const pages = getCurrentPages(); // 当前页面栈\n\n      if (pages[pages.length - 2].route === 'pages/TUI-Conversation/create-conversation/create' || pages[pages.length - 2].route === 'pages/TUI-Group/create-group/create' || pages[pages.length - 2].route === 'pages/TUI-Group/join-group/join') {\n        uni.navigateBack({\n          delta: 2\n        });\n      } else {\n        uni.navigateBack({\n          delta: 1\n        });\n      }\n\n      uni.$TUIKit.setMessageRead({\n        conversationID: this.conversationID\n      }).then(() => {});\n    }\n\n  }\n};\n</script>\n<style>\n@import \"./chat.css\";\n</style>\n","import mod from \"-!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./chat.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./chat.vue?vue&type=style&index=0&lang=css&\"","import 'uni-pages';wx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/TUI-Chat/chat.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./chat.vue?vue&type=template&id=5fe7757e&\"\nvar renderjs\nimport script from \"./chat.vue?vue&type=script&lang=js&\"\nexport * from \"./chat.vue?vue&type=script&lang=js&\"\nimport style0 from \"./chat.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/TUI-Chat/chat.vue\"\nexport default component.exports"],"sourceRoot":""}